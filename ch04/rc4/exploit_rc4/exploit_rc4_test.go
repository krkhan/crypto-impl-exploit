package exploit_rc4

import (
	"testing"
)

func TestCloneRC4(t *testing.T) {
	originalKey := []byte("TOPSECRET")
	recoveredKey := make([]byte, len(originalKey))

	for i := 0; i < len(originalKey); i++ {
		recoveredByte := RecoverRC4PSK(originalKey, i, 50000)
		t.Logf("recovered byte: 0x%02x\n", recoveredByte)
		recoveredKey[i] = recoveredByte
	}

	for i := 0; i < len(originalKey); i++ {
		if recoveredKey[i] != originalKey[i] {
			t.Fatalf("key mismatch, recovered: %v, original: %v\n", recoveredKey, originalKey)
		}
	}
}
