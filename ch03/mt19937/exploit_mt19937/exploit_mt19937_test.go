package exploit_mt19937

import (
	"math/rand"
	"testing"

	"github.com/krkhan/crypto-impl-exploit/ch03/mt19937/impl_mt19937"
)

func TestCloneMT19937(t *testing.T) {
	originalRng := impl_mt19937.NewMT19937()
	originalRng.Seed(rand.Uint32())

	clonedRng := CloneMT19937(originalRng)

	for i := 0; i < 100; i++ {
		cloned := clonedRng.Generate()
		observed := originalRng.Generate()
		if observed != cloned {
			t.Fatalf("observed: %08x, cloned: %08x", cloned, observed)
		}
		if i%20 == 0 {
			t.Logf("observed: %08x, cloned: %08x", cloned, observed)
		}
	}
}
